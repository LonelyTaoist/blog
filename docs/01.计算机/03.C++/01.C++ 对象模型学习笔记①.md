---
title: C++ 对象模型学习笔记①
date: 2022/03/26 23:08:55
permalink: /computer/C++/1
categories:
  - 计算机
  - C++
tags:
  -
---
# C++ 知识复习

## 内联函数

如果在类体中定义的成员函数中不包括循环等控制结构，C++会自动将它们作为内联(inline)函数来处理。如果成员函数不在类体内定义，而在类体外定义，系统并不把它默认为内联(inline )函数，如果想将这些成员函数指定为内置函数，应当用inline作显式声明。值得注意的是，如果在类体外定义inline函数，则必须将类定义和成员函数的定义都放在同一个头文件中(或者写在同一个源文件中)，否则编译时无法进行置换(将函数代码的拷贝嵌入到函数调用点)。

## static关键字

### 静态全局变量

静态变量都在全局数据区中分配内存；静态全局变量在声明它的整个文件都是可见的，而在文件之外是不可见的。

### 静态局部变量

静态变量都在全局数据区中分配内存；静态局部变量在程序执行到该对象的声明处时被首次初始化，即以后的函数调用不再进行初始化；静态局部变量一般在声明处初始化，如果没有显式初始化，会被程序自动初始化为 0；它始终驻留在全局数据区，直到程序运行结束。但其作用域为局部作用域，当定义它的函数或语句块结束时，其作用域随之结束。

### 静态类成员相关

静态成员是属于整个类的而不是某个对象，静态成员变量只存储一份供所有对象共用，所以在所有对象中都可以共享它。

注意：静态成员函数中不能调用非静态成员（非静态成员函数有 this 指针，而静态成员函数没有 this 指针）；非静态成员函数中可以调用静态成员；静态成员变量使用前必须先初始化。

## 虚继承

c++允许一个类继承多个父类（不被推荐），不过这样可能会出现菱形继承而歧义。为了避免这种情况，c++有了虚继承。虚继承时间效率上更慢，不过空间效率上更小(引入了虚基类指针)。

```cpp
class A
class B1:public virtual A;
class B2:public virtual A;
class D:public B1,public B2;
```

## 多态

多态意味着调用成员函数时，会根据调用函数的对象的类型来执行不同的函数。(多态都是通过指针来使用，变量赋值会割裂对象且赋值不支持多态)

```cpp
shape *ps = new circle();
ps->rotato();//调用circle的rotato函数

circle *pc = dynamic_cast<circle*>(ps)
```

## 指针类型

所有指针都只占用机器位数（32/64 bit）大小的空间，对指针自己而言其指向的对象是未知的，是编译器通过指针的类型来确定解析其指向的地址的方法（所以转型cast其实是一种编译器指令，转型只影响解释地址空间的方法）。
